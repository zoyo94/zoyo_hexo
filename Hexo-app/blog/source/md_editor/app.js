function a0_0x38ce(){const _0x180d32=['Content-Disposition','attachment;\x20filename=\x22','文件\x20','移动至','1VucDym','缺少需要打包的文件夹名','353786usiRxN','parse','Content-Type','express','tar','readdir','set','crypto','目录创建成功❤️','directory','directoryName','query','json','lastIndexOf','message','/upimg','.tar','files','文件写入失败','selectedFile','destination','已经把','mkdir','use','post','create','substring','file','existsSync','from','path','resolve','writeFile','catch','folderName','/directory-tree','name','获取目录树失败','toLowerCase','\x20不存在','extname','image','56883GZDGLt','push','originalname','multer','isDirectory','log','服务监听的端口为\x203001','error','缺少原点目录','then','application/octet-stream','目录已存在','send','/create_folder','1846032mzEJGB','single','body','pipe','join','创建目录失败','original_dir','md_file','filename','122432dHlFMR','replace','folderPath','get','Error\x20moving\x20image','No\x20file\x20uploaded.','mkdirSync','文件上传失败.','rename','567320KKDFPb','/tgz_download','531eLmYeR','2524137qZQsIh','status','test','/upload','memoryStorage','Image\x20moved\x20successfully❤️,已经把','缺少必要参数','/move_image','length','buffer','文件写入成功❤️','510715mrqFwV','/save_md','chdir'];a0_0x38ce=function(){return _0x180d32;};return a0_0x38ce();}const a0_0x151e84=a0_0x249b;(function(_0x37859b,_0x445a3c){const _0x409c40=a0_0x249b,_0x35834c=_0x37859b();while(!![]){try{const _0x4c60d0=-parseInt(_0x409c40(0x1ab))/0x1*(-parseInt(_0x409c40(0x1ad))/0x2)+parseInt(_0x409c40(0x1d7))/0x3+-parseInt(_0x409c40(0x1f7))/0x4+-parseInt(_0x409c40(0x205))/0x5+-parseInt(_0x409c40(0x1e5))/0x6+-parseInt(_0x409c40(0x1fa))/0x7+parseInt(_0x409c40(0x1ee))/0x8*(parseInt(_0x409c40(0x1f9))/0x9);if(_0x4c60d0===_0x445a3c)break;else _0x35834c['push'](_0x35834c['shift']());}catch(_0x4365bb){_0x35834c['push'](_0x35834c['shift']());}}}(a0_0x38ce,0x2d8ba));const express=require(a0_0x151e84(0x1b0)),multer=require(a0_0x151e84(0x1da)),fs=require('fs'),path=require(a0_0x151e84(0x1cb)),cors=require('cors'),crypto=require(a0_0x151e84(0x1b4)),tar=require(a0_0x151e84(0x1b1)),workDir=__dirname+'/public/uploads/';process[a0_0x151e84(0x207)](workDir);const app=express();app[a0_0x151e84(0x1c4)](cors());const upload=multer({'storage':multer[a0_0x151e84(0x1fe)](),'limits':{'fileSize':0x400*0x400*0x5},'fileFilter':function(_0x27cb3e,_0x49ea3a,_0x20488c){const _0x3bd52b=a0_0x151e84,_0xa11164=/md/,_0x3c8ac6=_0xa11164[_0x3bd52b(0x1fc)](path[_0x3bd52b(0x1d5)](_0x49ea3a[_0x3bd52b(0x1d9)])[_0x3bd52b(0x1d3)]());console[_0x3bd52b(0x1dc)](_0x3c8ac6),_0x3c8ac6?_0x20488c(null,!![]):_0x20488c(new Error('上传的文件不符.'));}});app[a0_0x151e84(0x1c5)](a0_0x151e84(0x1fd),upload[a0_0x151e84(0x1e6)](a0_0x151e84(0x1ec)),(_0x3f41f1,_0x31dd93)=>{const _0x63fd08=a0_0x151e84,_0xa8647f='md_editor/public/uploads/';console[_0x63fd08(0x1dc)](workDir);const _0x3b5779=_0x3f41f1['file'];if(!_0x3b5779){_0x31dd93[_0x63fd08(0x1fb)](0x190)[_0x63fd08(0x1b9)]({'success':![],'message':_0x63fd08(0x1f3)});return;}const _0x2af1af=_0x3b5779[_0x63fd08(0x1d9)];let _0x5798a1=decodeURIComponent(escape(_0x2af1af));const _0x3f931d=path[_0x63fd08(0x1e9)](workDir,_0x5798a1);fs[_0x63fd08(0x1cd)](_0x3f931d,_0x3b5779[_0x63fd08(0x203)],function(_0x25b3e7){const _0x371339=_0x63fd08;_0x25b3e7?(console[_0x371339(0x1de)](_0x25b3e7),_0x31dd93[_0x371339(0x1fb)](0x1f4)[_0x371339(0x1b9)]({'success':![],'message':_0x371339(0x1f5)})):_0x31dd93[_0x371339(0x1b9)]({'success':!![],'message':'md文件上传成功.','filePath':_0x3f931d,'filename':_0x5798a1,'destination':_0xa8647f});});});function a0_0x249b(_0x7ac55e,_0x36ed26){const _0x38cee4=a0_0x38ce();return a0_0x249b=function(_0x249bab,_0x5bb630){_0x249bab=_0x249bab-0x1aa;let _0x1b1b98=_0x38cee4[_0x249bab];return _0x1b1b98;},a0_0x249b(_0x7ac55e,_0x36ed26);}const upimg=multer({'storage':multer[a0_0x151e84(0x1fe)](),'limits':{'fileSize':0x400*0x400*0x32}});app[a0_0x151e84(0x1c5)](a0_0x151e84(0x1bc),upimg['array'](a0_0x151e84(0x1d6)),(_0x5946e1,_0x295df5)=>{const _0x351d5b=a0_0x151e84,_0x156eec=_0x5946e1['body']['destination'];let _0x4e93c5=[],_0x1fb209=[];for(let _0x226a6f=0x0;_0x226a6f<_0x5946e1[_0x351d5b(0x1be)][_0x351d5b(0x202)];_0x226a6f++){const _0x576bb2=_0x5946e1[_0x351d5b(0x1be)][_0x226a6f],_0x48f254=_0x576bb2[_0x351d5b(0x1d9)];let _0x688153=Buffer[_0x351d5b(0x1ca)](_0x48f254,'binary')['toString']('utf-8')['replace'](/\s/g,'_');const _0x51c51e=_0x688153[_0x351d5b(0x1ba)]('.');if(_0x51c51e>0x0){const _0x5e320f=_0x688153[_0x351d5b(0x1c7)](0x0,_0x51c51e)[_0x351d5b(0x1ef)](/\./g,'_'),_0xa51294=_0x688153[_0x351d5b(0x1c7)](_0x51c51e+0x1);_0x688153=_0x5e320f+'.'+_0xa51294;}const _0x407a69=''+_0x156eec+_0x688153;fs['writeFile'](_0x407a69,_0x576bb2[_0x351d5b(0x203)],function(_0x26f616){const _0x197d82=_0x351d5b;_0x26f616?(console[_0x197d82(0x1de)](_0x26f616),_0x295df5[_0x197d82(0x1fb)](0x1f4)[_0x197d82(0x1b9)]({'success':![],'message':_0x197d82(0x1bf)})):(_0x4e93c5[_0x197d82(0x1d8)](_0x407a69),_0x1fb209['push'](_0x688153),_0x226a6f===_0x5946e1['files'][_0x197d82(0x202)]-0x1&&_0x295df5[_0x197d82(0x1b9)]({'success':!![],'message':'图片上传成功❤️','imagePaths':_0x4e93c5,'filenames':_0x1fb209,'destination':_0x156eec}));});}});function readDirectory(_0x2f92fc){return new Promise((_0x58d0d2,_0x13bf20)=>{const _0x5d8d92=a0_0x249b;fs[_0x5d8d92(0x1b2)](_0x2f92fc,{'withFileTypes':!![]},(_0xa6063e,_0x5a8904)=>{const _0xcaa789=_0x5d8d92;if(_0xa6063e){_0x13bf20(_0xa6063e);return;}const _0x1a37ac=_0x5a8904['map'](_0x3ead60=>{const _0x175a7a=a0_0x249b,_0x5cfa53=path[_0x175a7a(0x1e9)](_0x2f92fc,_0x3ead60[_0x175a7a(0x1d1)]);return _0x3ead60[_0x175a7a(0x1db)]()?readDirectory(_0x5cfa53)[_0x175a7a(0x1e0)](_0x125ead=>({'name':_0x3ead60['name'],'children':_0x125ead,'type':_0x175a7a(0x1b6)})):Promise[_0x175a7a(0x1cc)]({'name':_0x3ead60[_0x175a7a(0x1d1)],'type':'file'});});Promise['all'](_0x1a37ac)[_0xcaa789(0x1e0)](_0x2d5f04=>{_0x58d0d2({'name':path['basename'](_0x2f92fc),'children':_0x2d5f04});})[_0xcaa789(0x1ce)](_0x40d5f0=>{_0x13bf20(_0x40d5f0);});});});}app[a0_0x151e84(0x1f1)](a0_0x151e84(0x1d0),(_0x555223,_0xbd007e)=>{const _0x5309d3=a0_0x151e84,_0x329982=_0x555223[_0x5309d3(0x1b8)][_0x5309d3(0x1b6)];if(!_0x329982){_0xbd007e[_0x5309d3(0x1fb)](0x190)[_0x5309d3(0x1b9)]({'error':_0x5309d3(0x200)});return;}readDirectory(_0x329982)[_0x5309d3(0x1e0)](_0x59a9eb=>{const _0x494dc9=_0x5309d3;_0xbd007e[_0x494dc9(0x1b9)](_0x59a9eb);})['catch'](_0x17efa4=>{const _0x1f2c85=_0x5309d3;console[_0x1f2c85(0x1de)](_0x17efa4),_0xbd007e['status'](0x1f4)[_0x1f2c85(0x1b9)]({'error':_0x1f2c85(0x1d2)});});});const save_md=multer({'storage':multer[a0_0x151e84(0x1fe)]()});app[a0_0x151e84(0x1c5)](a0_0x151e84(0x206),save_md[a0_0x151e84(0x1e6)](a0_0x151e84(0x1c8)),(_0xf6ed65,_0x348574)=>{const _0x561c3e=a0_0x151e84,_0xb0fa5e=_0xf6ed65[_0x561c3e(0x1e7)][_0x561c3e(0x1c1)],_0x4cee07=_0xf6ed65[_0x561c3e(0x1e7)][_0x561c3e(0x1ed)],_0x14471a=decodeURIComponent(_0x4cee07),_0x3f2f31=_0xf6ed65[_0x561c3e(0x1e7)]['currentContent'];fs['writeFile'](_0xb0fa5e+_0x14471a,_0x3f2f31,function(_0x2e1c71){const _0x573836=_0x561c3e;_0x2e1c71?(console[_0x573836(0x1de)](_0x2e1c71),_0x348574[_0x573836(0x1fb)](0x1f4)['json']({'success':![],'message':'文件写入失败'})):_0x348574['json']({'success':!![],'message':_0x573836(0x204),'filepath':_0x14471a});});});const create_folder=multer({'storage':multer[a0_0x151e84(0x1fe)]()});app['post'](a0_0x151e84(0x1e4),create_folder[a0_0x151e84(0x1e6)](a0_0x151e84(0x1c8)),(_0x2a0204,_0x5bb7b3)=>{const _0x265b16=a0_0x151e84,_0xfd89e8=_0x2a0204[_0x265b16(0x1e7)][_0x265b16(0x1f0)],_0x114345=_0x2a0204[_0x265b16(0x1e7)][_0x265b16(0x1cf)],_0x1f07f6=path['join'](_0xfd89e8,_0x114345);fs[_0x265b16(0x1c9)](_0x1f07f6)?_0x5bb7b3[_0x265b16(0x1fb)](0x1f4)[_0x265b16(0x1b9)]({'success':![],'message':_0x265b16(0x1e2)}):fs[_0x265b16(0x1c3)](_0x1f07f6,function(_0x27b2fe){const _0x14d1bb=_0x265b16;_0x27b2fe?(console[_0x14d1bb(0x1de)](_0x27b2fe),_0x5bb7b3['status'](0x1f4)['json']({'success':![],'message':_0x14d1bb(0x1ea)})):_0x5bb7b3[_0x14d1bb(0x1b9)]({'success':!![],'message':_0x14d1bb(0x1b5),'folderpath':_0x1f07f6});});});const move_image=multer({'storage':multer[a0_0x151e84(0x1fe)]()});app[a0_0x151e84(0x1c5)](a0_0x151e84(0x201),move_image['single'](a0_0x151e84(0x1c8)),(_0x212563,_0x45cdfc)=>{const _0x36ac9a=a0_0x151e84,{folderName:_0x5bb204,fileName:_0x589463,new_folderName:_0x568273,original_dir:_0x2b3433,match:_0x33f840}=_0x212563[_0x36ac9a(0x1e7)],_0x541010=JSON[_0x36ac9a(0x1ae)](_0x33f840);!fs[_0x36ac9a(0x1c9)](_0x568273)&&fs[_0x36ac9a(0x1f4)](_0x568273);const _0xb353e3=path[_0x36ac9a(0x1e9)](_0x2b3433,_0x5bb204,_0x589463),_0x559658=path['join'](_0x2b3433,_0x568273,_0x589463);fs[_0x36ac9a(0x1f6)](_0xb353e3,_0x559658,_0x102a88=>{const _0x389088=_0x36ac9a;_0x102a88?(console[_0x389088(0x1de)](_0x102a88),_0x45cdfc[_0x389088(0x1fb)](0x1f4)['send']({'success':![],'error':_0x389088(0x1f2)})):(console['log'](_0x389088(0x1c2)+_0x589463+'从'+workDir+_0x5bb204+'移动至'+workDir+_0x568273),_0x45cdfc[_0x389088(0x1e3)]({'success':!![],'__dirname':__dirname,'message':_0x389088(0x1ff)+_0x589463+'从'+workDir+_0x5bb204+_0x389088(0x1aa)+workDir+_0x568273,'data':{'__dirname':__dirname,'original_dir':_0x2b3433,'folderName':_0x5bb204,'fileName':_0x589463,'match':_0x33f840,'new_folderName':_0x568273}}));});}),app[a0_0x151e84(0x1f1)](a0_0x151e84(0x1f8),(_0x1cc8a8,_0x51650f)=>{const _0x923b9f=a0_0x151e84;try{const _0xe6da35=_0x1cc8a8[_0x923b9f(0x1b8)][_0x923b9f(0x1b7)];if(!_0xe6da35)throw new Error(_0x923b9f(0x1ac));const _0x325328=_0x1cc8a8[_0x923b9f(0x1b8)][_0x923b9f(0x1eb)];if(!_0x325328)throw new Error(_0x923b9f(0x1df));const _0x3b71e3=_0x1cc8a8[_0x923b9f(0x1b8)][_0x923b9f(0x1c0)],_0x4187db=_0xe6da35+_0x923b9f(0x1bd),_0x56b726=encodeURIComponent(_0x4187db);if(!fs[_0x923b9f(0x1c9)](_0xe6da35))throw new Error('文件夹\x20'+_0xe6da35+_0x923b9f(0x1d4));if(_0x3b71e3&&!fs[_0x923b9f(0x1c9)](_0x3b71e3))throw new Error(_0x923b9f(0x20a)+_0x3b71e3+_0x923b9f(0x1d4));const _0x2c0dc9=tar[_0x923b9f(0x1c6)]({'gzip':!![]},_0x3b71e3?[_0xe6da35,_0x3b71e3]:[_0xe6da35]);_0x51650f['set'](_0x923b9f(0x1af),_0x923b9f(0x1e1)),_0x51650f[_0x923b9f(0x1b3)](_0x923b9f(0x208),_0x923b9f(0x209)+_0x56b726+'\x22'),_0x2c0dc9[_0x923b9f(0x1e8)](_0x51650f);}catch(_0xdb8236){console['error'](_0xdb8236),_0x51650f[_0x923b9f(0x1fb)](0x1f4)['send'](_0xdb8236[_0x923b9f(0x1bb)]);}}),app['listen'](0xbb9,()=>{const _0x52be59=a0_0x151e84;console[_0x52be59(0x1dc)](_0x52be59(0x1dd));});